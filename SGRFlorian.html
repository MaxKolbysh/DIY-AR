<!DOCTYPE HTML>
<!--
	Hielo by TEMPLATED
	templated.co @templatedco
	Released for free under the Creative Commons Attribution 3.0 license (templated.co/license)
-->
<html>
	<head>
		<title>test WebGL</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<link rel="shortcut icon" href="images/favicon_color.png" type="image/png">
	    
	    
	    <!-- The following libraries and polyfills are recommended to maximize browser support -->
	    <!-- NOTE: you must adjust the paths as appropriate for your project -->
	    
	    	    <!-- 游뚿 REQUIRED: Web Components polyfill to support Edge and Firefox < 63 -->
	    <script src="https://unpkg.com/@webcomponents/webcomponentsjs@2.1.3/webcomponents-loader.js"></script>

	    <!-- 游누 OPTIONAL: Intersection Observer polyfill for better performance in Safari and IE11 -->
	    <script src="https://unpkg.com/intersection-observer@0.5.1/intersection-observer.js"></script>

	    <!-- 游누 OPTIONAL: Resize Observer polyfill improves resize behavior in non-Chrome browsers -->
	    <script src="https://unpkg.com/resize-observer-polyfill@1.5.0/dist/ResizeObserver.js"></script>

	    <!-- 游누 OPTIONAL: Fullscreen polyfill is needed to fully support AR features -->
	    <script src="https://unpkg.com/fullscreen-polyfill@1.0.2/dist/fullscreen.polyfill.js"></script>

	    <!-- 游누 OPTIONAL: Include prismatic.js for Magic Leap support -->
	    <script src="https://unpkg.com/@magicleap/prismatic/prismatic.min.js"></script>
	    
	    <!-- 游누 OPTIONAL: The :focus-visible polyfill removes the focus ring for some input types -->
	    <script src="https://unpkg.com/focus-visible@5.0.2/dist/focus-visible.js" defer></script>
	    <!-- Global site tag (gtag.js) - Google Analytics -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=G-38E6070C8J"></script>
		
	</head>
	<body class="subpage-nordfox">

		
								
								<header class="nordfox-header">
									<a href="https://hub.saint-gobain.ru/" target="_blank">
										<img class="hub-img-logo" src="images/Group 2.png">
									</a>	
										
									
									<div>	
										<h2>SGR test </h2>
										<h3>html annotations</h3>
									</div>
									
								</header>
								<div id="card">
								    
									
									<!-- pol.plav.vl.plitka.b (Max 햌) -->
									
									<model-viewer ondblclick="addHotspot()" onclick="selected()" id="modelblock" bounds="tight" enable-pan src="models/Florianmodel.glb" ar ar-modes="webxr scene-viewer quick-look fallback" ar-scale="auto" magic-leap camera-controls environment-image="neutral" poster="poster.webp" shadow-intensity="1" autoplay>
										
										<div id="controls" class="dim">
											<label for="src">Sensors:</label>
											<select id="src">
											  <option value="">Data1</option>
											  <option value="">Data2</option>
											  <option value="">Data3</option>
											</select><br>
											<form onSubmit="return false;">
											
												<input type="text" id="hotspottext" name="hotspottext" placeholder="Input sensor name">
											</form>	
											<div class="center"><button class="btn" onclick="removeHotspot()">Remove last Data</button></div>
											
										  </div>
										<div class="progress-bar hide" slot="progress-bar">
											<div class="update-bar"></div>
										</div>
										
									</model-viewer>


									

									<script>
										function selected(){
												// Add active class to the current button (highlight it)
									let header = document.getElementById("modelblock");
									let hotspots = header.getElementsByClassName("hotspot");
									for (let i = 0; i < hotspots.length; i++) {
									  hotspots[i].addEventListener("click", function() {
									 let current = document.getElementsByClassName("selected");
									  if (current.length > 0) { 
										current[0].className = current[0].className.replace(" selected", "");
									  }
									  this.className += " selected";
									  });
									}
									
										}
									
									
										</script>
											
									<script>
										//hotspot counter so we can keep track of how many we added on 3 because we already have hotspot-0 and hotspot-1 (set to 0 if you start with 0 hotspots)
										let hotspotCounter = 0;
										function addHotspot(MouseEvent) {
											let inputtext = document.querySelector('input').value;
									
											// if input = nothing then alert error if it isnt then add the hotspot
											if (inputtext == ""){
										alert("Put in text first to add hotspots.");
									}else{
										   
										  const viewer = document.querySelector('#modelblock');
										const rect = viewer.getBoundingClientRect();
									
									const x = event.clientX - rect.left;
									const y = event.clientY - rect.top;
									const positionAndNormal = viewer.positionAndNormalFromPoint(x, y);
									
									// if the model is not clicked return the position in the console
									if (positionAndNormal == null) {
									console.log('no hit result: mouse = ', x, ', ', y);
									return;
									}
									const {position, normal} = positionAndNormal;
									
									// create the hotspot
									const hotspot = document.createElement('button');
									hotspot.slot = `hotspot-${hotspotCounter ++}`;
									hotspot.classList.add('hotspot');
									hotspot.id = `hotspot-${hotspotCounter}`;
									hotspot.dataset.position = position.toString();
									if (normal != null) {
									hotspot.dataset.normal = normal.toString();
									}
									viewer.appendChild(hotspot);
									console.log('mouse = ', x, ', ', y, positionAndNormal);
									
									
									// adds the text to last hotspot
									let element = document.createElement("div");
									element.classList.add('annotation');
									element.appendChild(document.createTextNode(inputtext));
									document.getElementById(`hotspot-${hotspotCounter}`).appendChild(element);
									
									document.querySelector('input').value = "";
									}
									}
									
									</script>
									<script>
										function removeHotspot(){
										let el = document.getElementById(`hotspot-${hotspotCounter}`);
										
										if (el == null){
											alert("No hotspots to delete");
										}else{
											hotspotCounter --;
									el.remove()}; // Removes the last added hotspot
									}
									</script>

									

									

									
									

								<span class = "picture-gyproc-text">Ar mode disabele</span>

								    
								</div>
								


					</div>
				</div>
			</section>

		
		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/skel.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
			<!-- 游누 Include both scripts below to support all browsers! -->

		
		    <!-- Loads <model-viewer> for modern browsers: -->
			<script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.js"></script>

			<!-- Loads <model-viewer> for old browsers like IE11: -->
			<script nomodule src="https://unpkg.com/@google/model-viewer/dist/model-viewer-legacy.js"></script>
	</body>
</html>
